Usage
======

CONFIGURATIONS.TXT:
Within configurations.txt you find the following parameters:
active_ransomware: Mandatory, location of the ransomware that is to be decrypted.
decryption_start: Mandatory, folder in which the decryptor should recursively decrypt.
delete_ransom_files: Mandatory, True/False if encrypted files should be deleted.
key_path: Optional, folder in case of Lockbit to store decryption keys in.
log_file: Mandatory, location in which we can write the logs to.

Example usage:
active_ransomware: revil.txt
decryption_start: C:\Users\nw
delete_ransom_files: False
key_path: C:\Users\nw\Desktop\LockbitDecryptor\Keys\Keys\
log_file: C:\Users\nw\Desktop\logs.txt


LOCKBIT.TXT:
Only variables n,e,d,p,q,e1,e2,coef must be extracted from the decryptor. Offsets should not be touched unless ransomware structure changes!
[lockbit.txt]

Extension: .lockbit

Methodology: Assemble_RSA, Decrypt_RSA_big, Assemble_session_RSA, Decrypt_RSA_small, AES_CBC

n: 17811946327405659198529431417605595714450298668077360009484341101698450744276717037028914948267141502035461872355497701183228947383847517485032332713397452922668823371200280020729314143158888093823136906811194993670438627956329255674024843115380656846884914424972872414264051029757546108695745196133227436021495214981440986813220554015475434830291614868173789586507160374594303631478697207031659509166161549852767491506127238783704372524872469418220739904430915006952837791116130253941890599504330825011964708758553528101130618330648953097841522810773391859484928165592840490058565605033056036230029993954778728834251
e: 65537
d: 737623362872559913709948225695127741108352695197551841947914944993051182079848177952858311634603690076204945627245994797004491557437205890632432839223044802662971857568054075961050377413266128852953195371859914442552610529524964522320268309735616562894939618068821821754316408971450938233368211274632333816952407226978729605129930918548079335426684450433668134396408435501419917488259785132756653493446988439528434420600668848573629525369854514224764003250992615579841875404021923065994437614945224420931726163865883218384204150275845694285690433030945872115570951431111851107061057950221122611066444993453786955137
p: 120682332495460192658811942327939205619467332428192856217334269704118976700525394978809492847150818961345819956062505728173399193141674240152622461982612721489336335159224227459783780740474628467861498351510394992114750068471331279449159110906667506298983963481155770505970005303965930693569104641164637071713
q: 147593653180971671630171472968617435335884150310331983076333239209802513131863212846706759134030892512138323494461920111916397722237738693636150426582310005708123051994715616763581594751083472566725709448576519813789049029816494601590118338942221913672984200659666522793767097561204433995760224046119310746027
e1: 20088248854738166863221988782756134612551217319363960335000069398999556232754497975553241031319228589183538305090038832852337027907632700395577436223329145043672583124829899100642099334693954895034882364414405587209970070295462912972990474707124766562638144218013157459902448813051624852162066657467766693857
e2: 5776549436336608903846526819422673018852599990020927668199562973177646919804524786789185302634988469011929135653063537956658988930524737921734681846645790387740293702281849291218499329180907077431854444597689447523824873910604828617096503339896534912663144097106132886247655602857765433253352681360087157843
coef: 96933279430490063854989887223389941936862212162641003423400052185237609551231163839649296465311762908018929196731592988411762753249271748160018503637042656504182673735082112177549057417375630336788860301218582250978292538603708431139652606659361375762662009514904055732110300992182969364795508704884024093330

Encd_session_key_offset: -1296
Encd_session_key_length: 1280

RSA_size: 2048

n_length = 512
e_length = 518
d_length = 1030
p_length = 1286
q_length = 1542
dp_length = 1798
dq_length = 2054
qp_length = 2310


RSA_encd_data_offset: -1552
RSA_encd_data_length: 256

AES_size: 128
AES_mode: MODE_CBC
AES_chunk_size: 131072
Meta_data_offset: 1552




=======================================================================

REVIL.TXT:
Extension must be changed to the incident's extension.
CRC1-3 are optional but advised (for integrity) in Revil.
Offsets should not be touched unless ransomware structure changes!
Master_sk should be changed to incident's private key.
[revil.txt]

Extension: .7094h8zb7o

Methodology: CRC_1, CRC_2, CRC_3, Master_sk, Decode_key_1, Curve25591_1, SHA3, AES, Cut, Curve25591_2, SHA3, Salsa20

Master_sk: fw3wr42KGihNMzIqQ1befcTRrDEYM2dKhAXVaLITjyE=

CRC_1_hash_offset: -16
CRC_1_hash_length: 4
CRC_1_data_offset: -56
CRC_1_data_length: 32

CRC_2_hash_offset: -148
CRC_2_hash_length: 4
CRC_2_data_offset: -232
CRC_2_data_length: 36

CRC_3_hash_offset: -60
CRC_3_hash_length: 4
CRC_3_data_offset: -144
CRC_3_data_length: 36

Decode_key_1: Master_sk

Curve25591_1_public_offset: -196
Curve25591_1_public_length: 32
Curve25591_1_secret: Decode_key_1

AES_size: 256
AES_mode: MODE_CTR
AES_iv_offset: -164
AES_iv_length: 16
AES_data_offset: -232
AES_data_length: 36

Cut_offset_start: 4
Cut_offset_end: 36

Curve25591_2_public_offset: -56
Curve25591_2_public_length: 32
Curve25591_2_secret: aes_decrypted_data

Salsa20_nonce_offset: -24
Salsa20_nonce_length: 8
Salsa20_encd_null_bytes_offset: -4
Salsa20_encd_null_bytes_length: 4
Salsa20_decryption_mode_offset: -12
Salsa20_decryption_mode_length: 4
Salsa20_skip_size_offset: -8
Salsa20_skip_size_length: 4
Salsa20_cipher_update: 15

Meta_data_offset: -232
